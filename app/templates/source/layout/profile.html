{% extends "layout/layout_base.html" %}

{% block stylesheets %}
    <link rel='stylesheet' href='{{ asset.style('profile', 'openfire') }}'>
{% endblock stylesheets %}

{% block main %}

    <!-- Main Masthead -->
    <div id='masthead'>

        <div id='profiletop'>

            <!-- Avatar Stack -->
            <div class='left'>

                <div id='avatar'>
                    <img {{ {
                        'src': user.has_avatar() and user.get_avatar_url('jpg', '175') or gravatarify(user.email[0].id(), 'jpg', '175'),
                        'width': '175',
                        'height': '175',
                        'alt': 'you!',
                        'onclick': "javascript:window.location.href='%s';" % link('user/me')
                    }|xmlattr }} /></a>
                </div><!-- end #avatar -->

                <div id='byline' class='collapsed foldable'>

                    <div id='topbanner'>
                        <h1 id='name'>{{ user.firstname }} {{ user.lastname }}</h1>
                        <h3 id='topics'>
                            <span class='interest topic' data-topic-slug='technology'>Technology</span>,
                            <span class='interest topic' data-topic-slug='dentistry'>Dentistry</span>,
                            <span class='interest topic' data-topic-slug='taxidermy'>Taxidermy</span>
                        </h3><!-- end #topics -->
                        <div class='clearfix'></div>
                    </div><!-- end #name+topics -->

                    <div id='userinfo'>
                        <ul>
                            <li>{{ user.position }} @ {{ user.organization }}</li>
                            <li>located in <a href="#">{{ user.location|lower }}</a></li>
                        </ul>
                    </div><!-- end #userinfo -->

                </div><!-- end #byline -->

            </div><!-- end .left -->

        </div><!-- end #profiletop -->

    </div><!-- end #masthead -->

    <!-- Content Fold -->
    <div id='content'>
        <div id="fb-root"></div>

        <!-- Profile Content -->
        <div id='profile'>

            <div id='leftbar'>
                leftbar herr
            </div><!-- end #leftbar -->

            <div id='contentpane'>

                <div id='userbio' class='collapsed profile section'>
                    <div class='truncated'>{{ user.bio|truncate(250, true)|lower }}</div>
                    <div class='hidden original'>{{ user.bio|lower }}</div>
                </div><!-- end #userbio -->

               <div id='freeform' class='collapsed profile section'>
                    {% block freeform %}
                        <div {{ {

                            'id': 'profile_freeform',
                            'data-keyname': 'profile_freeform' if edit_privs == true else none,
                            'data-namespace': encrypt(user.key.urlsafe()) if edit_privs == true else none,
                            'class': 'dynamic mini-editable' if edit_privs == true else 'dynamic'

                        }|xmlattr }}>

                            {% content 'profile_freeform', user.key.urlsafe() %}
                                <b>Default content! I am overridden when you edit!</b>
                            {% endcontent %}

                        </div><!-- end #profile_freeform -->
                    {% endblock freeform %}
                </div><!-- end #freeform -->

            </div><!-- end #contentpane -->

        </div><!-- end #profile -->
    </div><!-- end #content -->

{% endblock %}
